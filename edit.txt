import { createProxyMiddleware } from 'http-proxy-middleware';

const apiProxy = createProxyMiddleware({
  target: 'https://api.example.com', // آدرس سرور مقصد
  changeOrigin: true,
  pathRewrite: {
    '^/api': '', // حذف پیشوند `/api` از آدرس
    '^/uploads': '/uploads', // نگه داشتن مسیر `/uploads` بدون تغییر
  },
});

export default function handler(req, res) {
  apiProxy(req, res, (err) => {
    if (err) {
      throw err;
    }
  });
}

export const config = {
  api: {
    bodyParser: false, // غیرفعال کردن پارسینگ بدنه برای پروکسی
  },
};